tuss/sigtap

this branch was created to debug a problem introduced by resampling.

when training the classifier using train_test_split(), even with train 
proportions of up to 99.9%, the accuracy falls absurdely. see logs below: 
- 1300 codes got right when trained with full test set (5769)
- 2 codes got right when trained with sample of 99% of test set (5711)
- 0 codes got right when trained with sample of 99.9% of test set (5763)

accuraccy for chapter prediction falls around 50%.


-- this is output from the original script from master branch

djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:13:02.630125 Iniciando round 0 de resampling
train_size=0, test_size=0
docs2 = 5769, train = 5711, test = 58
2018-03-02 09:13:02.643111 Carregando o modelo
MatrixSimilarity<5711 docs, 6000 features>
2018-03-02 09:13:03.787919 Modelo treinado
2018-03-02 09:13:03.790515 Validando Modelo de Comparacao
2018-03-02 09:14:34.269223 Fim da validação
Teste do modelo: Codigos;2 Capitulo=1582 Grupo=392 SubGrupo=354
Teste do modelo: Codigos;0.00046522447080716444 Capitulo=0.36799255640846706 Grupo=0.09118399627820423 SubGrupo=0.08234473133286811
>2,1582,392,354,4299

djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:14:53.770244 Iniciando round 0 de resampling
train_size=0, test_size=0
docs2 = 5769, train = 5763, test = 6
2018-03-02 09:14:53.772436 Carregando o modelo
MatrixSimilarity<5763 docs, 6000 features>
2018-03-02 09:14:55.229405 Modelo treinado
2018-03-02 09:14:55.233415 Validando Modelo de Comparacao
2018-03-02 09:16:31.032473 Fim da validação
Teste do modelo: Codigos;0 Capitulo=1668 Grupo=425 SubGrupo=315
Teste do modelo: Codigos;0.0 Capitulo=0.38799720865317516 Grupo=0.09886020004652245 SubGrupo=0.0732728541521284
>0,1668,425,315,4299



djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:23:05.212933 Iniciando round 0 de resampling
train_size=0, test_size=1
docs2 = 5769, train = 5769, test = 5769
2018-03-02 09:23:05.213041 Carregando o modelo
MatrixSimilarity<5769 docs, 6000 features>
2018-03-02 09:23:06.693735 Modelo treinado
2018-03-02 09:23:06.696679 Validando Modelo de Comparacao

2018-03-02 09:24:42.193828 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299


-- this is output from this debug-1 branch; see how the performance is always the same, even removing up to 10 samples from the bottom (no shuffling)

djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:23:05.212933 Iniciando round 0 de resampling
train_size=0, test_size=1
docs2 = 5769, train = 5769, test = 5769
2018-03-02 09:23:05.213041 Carregando o modelo
MatrixSimilarity<5769 docs, 6000 features>
2018-03-02 09:23:06.693735 Modelo treinado
2018-03-02 09:23:06.696679 Validando Modelo de Comparacao

2018-03-02 09:24:42.193828 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
djogo@infomed01:~/git/tuss_sigtap/src$ 
djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:30:19.565706 Iniciando round 0 de resampling (reduzindo amostras para debug-1)
train_size=5769
docs2 = 5769, train = 5769
2018-03-02 09:30:19.565919 Carregando o modelo
MatrixSimilarity<5769 docs, 6000 features>
2018-03-02 09:30:20.631991 Modelo treinado
2018-03-02 09:30:20.634551 Validando Modelo de Comparacao
2018-03-02 09:31:50.880787 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
djogo@infomed01:~/git/tuss_sigtap/src$ (python3 sigtap_tuss_tf_idf.py)
2018-03-02 09:33:48.496674 Iniciando round 1 de resampling (reduzindo amostras para debug-1)
train_size=5768
docs2 = 5769, train = 5768
2018-03-02 09:33:48.496884 Carregando o modelo
MatrixSimilarity<5768 docs, 6000 features>
2018-03-02 09:33:49.698882 Modelo treinado
2018-03-02 09:33:49.701438 Validando Modelo de Comparacao
2018-03-02 09:35:16.261221 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:35:16.261560 Iniciando round 2 de resampling (reduzindo amostras para debug-1)
train_size=5767
docs2 = 5769, train = 5767
2018-03-02 09:35:16.261708 Carregando o modelo
MatrixSimilarity<5767 docs, 6000 features>
2018-03-02 09:35:17.364947 Modelo treinado
2018-03-02 09:35:17.373416 Validando Modelo de Comparacao
2018-03-02 09:36:44.851898 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:36:44.852279 Iniciando round 3 de resampling (reduzindo amostras para debug-1)
train_size=5766
docs2 = 5769, train = 5766
2018-03-02 09:36:44.852458 Carregando o modelo
MatrixSimilarity<5766 docs, 6000 features>
2018-03-02 09:36:45.959817 Modelo treinado
2018-03-02 09:36:45.978161 Validando Modelo de Comparacao
2018-03-02 09:38:20.762636 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:38:20.762968 Iniciando round 4 de resampling (reduzindo amostras para debug-1)
train_size=5765
docs2 = 5769, train = 5765
2018-03-02 09:38:20.763114 Carregando o modelo
MatrixSimilarity<5765 docs, 6000 features>
2018-03-02 09:38:21.837919 Modelo treinado
2018-03-02 09:38:21.846287 Validando Modelo de Comparacao
2018-03-02 09:39:57.595245 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:39:57.595571 Iniciando round 5 de resampling (reduzindo amostras para debug-1)
train_size=5764
docs2 = 5769, train = 5764
2018-03-02 09:39:57.595726 Carregando o modelo
MatrixSimilarity<5764 docs, 6000 features>
2018-03-02 09:39:58.645205 Modelo treinado
2018-03-02 09:39:58.657156 Validando Modelo de Comparacao
2018-03-02 09:41:25.177915 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:41:25.178382 Iniciando round 6 de resampling (reduzindo amostras para debug-1)
train_size=5763
docs2 = 5769, train = 5763
2018-03-02 09:41:25.178553 Carregando o modelo
MatrixSimilarity<5763 docs, 6000 features>
2018-03-02 09:41:26.287397 Modelo treinado
2018-03-02 09:41:26.296297 Validando Modelo de Comparacao
2018-03-02 09:42:53.394465 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:42:53.394836 Iniciando round 7 de resampling (reduzindo amostras para debug-1)
train_size=5762
docs2 = 5769, train = 5762
2018-03-02 09:42:53.394989 Carregando o modelo
MatrixSimilarity<5762 docs, 6000 features>
2018-03-02 09:42:54.484965 Modelo treinado
2018-03-02 09:42:54.496052 Validando Modelo de Comparacao
2018-03-02 09:44:19.902131 Fim da validação          
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:44:19.902602 Iniciando round 8 de resampling (reduzindo amostras para debug-1)
train_size=5761
docs2 = 5769, train = 5761
2018-03-02 09:44:19.902757 Carregando o modelo
MatrixSimilarity<5761 docs, 6000 features>
2018-03-02 09:44:20.997840 Modelo treinado
2018-03-02 09:44:21.006398 Validando Modelo de Comparacao
2018-03-02 09:45:46.857011 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299
2018-03-02 09:45:46.857344 Iniciando round 9 de resampling (reduzindo amostras para debug-1)
train_size=5760
docs2 = 5769, train = 5760
2018-03-02 09:45:46.857496 Carregando o modelo
MatrixSimilarity<5760 docs, 6000 features>
2018-03-02 09:45:47.929489 Modelo treinado
2018-03-02 09:45:47.941036 Validando Modelo de Comparacao
2018-03-02 09:47:13.042277 Fim da validação
Teste do modelo: Codigos;1300 Capitulo=3487 Grupo=3031 SubGrupo=2519
Teste do modelo: Codigos;0.3023959060246569 Capitulo=0.8111188648522912 Grupo=0.7050476855082577 SubGrupo=0.5859502209816236
>1300,3487,3031,2519,4299

